@model MovieDemo.Models.MovieList

@{
    ViewData["Title"] = Model.Title;

    // THEME LOGIC: One file, different styles
    bool isSeen = Model.Title == "Seen Content";
    bool isWatchlist = Model.Title == "Watchlist";

    string themeColor = isSeen ? "warning" : (isWatchlist ? "info" : "light");
    string icon = isSeen ? "bi-eye-fill" : (isWatchlist ? "bi-bookmark-fill" : "bi-collection-play");
    string headerGradient = isSeen ? "rgba(255, 193, 7, 0.1)" : (isWatchlist ? "rgba(13, 202, 240, 0.1)" : "rgba(255,255,255,0.05)");
}

<div class="container-fluid px-5 mt-4">
    @* Navigation Bar *@
    <nav aria-label="breadcrumb" class="mb-4">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a asp-action="MyLibrary" class="text-secondary text-decoration-none small text-uppercase fw-bold">Library</a></li>
            <li class="breadcrumb-item active text-@themeColor small text-uppercase fw-bold" aria-current="page">@Model.Title</li>
        </ol>
    </nav>

    @* Dynamic Header *@
    <div class="p-5 rounded-4 mb-5 shadow-lg border border-secondary" style="background: linear-gradient(135deg, @headerGradient 0%, #000 100%);">
        <div class="row align-items-center">
            <div class="col-auto">
                <div class="display-icon bg-@themeColor shadow-lg">
                    <i class="bi @icon text-black"></i>
                </div>
            </div>
            <div class="col">
                <h1 class="display-3 fw-bold text-white mb-0">@Model.Title</h1>
                <p class="text-secondary fs-5 mb-0">
                    <span class="badge bg-dark text-@themeColor border border-@themeColor me-2">@(Model.IsSystemList ? "Official List" : "Personal Collection")</span>
                    @Model.Items.Count Titles
                </p>
            </div>
            <div class="col-auto">
                <a asp-action="IndexM" class="btn btn-outline-@themeColor btn-lg rounded-pill px-5 fw-bold shadow">
                    <i class="bi bi-plus-circle me-2"></i> Add Movies
                </a>
            </div>
        </div>
    </div>

    @* The Grid *@
    @if (!Model.Items.Any())
    {
        <div class="text-center py-5 border border-secondary border-dashed rounded-5 opacity-75">
            <i class="bi bi-camera-reels text-secondary display-1"></i>
            <h2 class="text-white mt-3">This collection is empty</h2>
            <p class="text-secondary">Explore the network and add content to your "@Model.Title" list.</p>
        </div>
    }
    else
    {
        <div class="row row-cols-2 row-cols-md-4 row-cols-lg-6 g-4 mb-5">
            @foreach (var item in Model.Items.OrderByDescending(i => i.DateAdded))
            {
                <div class="col">
                    <div class="card h-100 bg-transparent border-0 movie-item-card">
                        <div class="position-relative overflow-hidden rounded-4 shadow-lg border border-dark">
                            <img src="@(item.Movie.PosterUrl?.StartsWith("http") == true ? item.Movie.PosterUrl : "https://image.tmdb.org/t/p/w500" + item.Movie.PosterUrl)"
                                 class="card-img-top poster-img" alt="@item.Movie.Title">

                            @* Interactive Overlay *@
                            <div class="card-img-overlay d-flex flex-column justify-content-between">
                                <div class="text-end">
                                    <form asp-action="RemoveFromList" method="post">
                                        <input type="hidden" name="listItemId" value="@item.Id" />
                                        <button type="submit" class="btn btn-remove shadow-sm" title="Remove from list">
                                            <i class="bi bi-trash3-fill"></i>
                                        </button>
                                    </form>
                                </div>
                                <div class="text-center">
                                    <a asp-action="Details" asp-route-id="@item.MovieId" class="btn btn-@themeColor btn-sm w-100 fw-bold rounded-pill mb-2">
                                        View Info
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="mt-3 px-1">
                            <h6 class="text-white mb-0 text-truncate fw-bold">@item.Movie.Title</h6>
                            <div class="d-flex justify-content-between align-items-center">
                                <small class="text-secondary">@item.Movie.ReleaseDate</small>
                                <small class="text-@themeColor" style="font-size: 0.7rem;">Added @item.DateAdded.ToString("MMM d")</small>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    }
</div>

<style>
    .display-icon {
        width: 100px;
        height: 100px;
        border-radius: 25px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 3.5rem;
    }

    .movie-item-card {
        transition: all 0.3s ease;
    }

    .poster-img {
        aspect-ratio: 2/3;
        object-fit: cover;
        transition: transform 0.6s ease;
    }

    .movie-item-card:hover .poster-img {
        transform: scale(1.1) rotate(1deg);
    }

    .card-img-overlay {
        background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, transparent 50%, rgba(0,0,0,0.5) 100%);
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .movie-item-card:hover .card-img-overlay {
        opacity: 1;
    }

    .btn-remove {
        background: rgba(220, 53, 69, 0.9);
        color: white;
        border: none;
        width: 38px;
        height: 38px;
        border-radius: 12px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        transition: 0.2s;
    }

        .btn-remove:hover {
            background: #ff0000;
            transform: scale(1.1);
            color: white;
        }

    .border-dashed {
        border-style: dashed !important;
        border-width: 3px !important;
    }
</style>